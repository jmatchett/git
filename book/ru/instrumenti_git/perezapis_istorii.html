<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Перезапись истории | Learn Git</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="jmatchett">
        <meta name="description" content="This is a GitBook version of the Scott Chacon&#39;s book: [Pro Git](https://github.com/progit/progit).">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../instrumenti_git/otladka_s_pomoschyu_git.html" />
        
        
        <link rel="prev" href="../instrumenti_git/pryatane.html" />
        

        <meta property="og:title" content="Перезапись истории | Learn Git">
        <meta property="og:site_name" content="Learn Git">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/jmatchett">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="jmatchett/git" data-level="6.4" data-basepath=".." data-revision="1398354154484">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/jmatchett/git" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/jmatchett/git/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/jmatchett/git/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="../" >Learn Git</a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/jmatchett" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/jmatchett/git/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/jmatchett/git/edit/master/instrumenti_git/perezapis_istorii.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="nastroika_git/README.html">
                
                <a href="../nastroika_git/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> Настройка Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="nastroika_git/konfigurirovanie_git.html">
                            
                            <a href="../nastroika_git/konfigurirovanie_git.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> Конфигурирование Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="nastroika_git/git_atributi.html">
                            
                            <a href="../nastroika_git/git_atributi.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> Git-атрибуты
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="nastroika_git/perehvatchiki_v_git.html">
                            
                            <a href="../nastroika_git/perehvatchiki_v_git.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> Перехватчики в Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="nastroika_git/primer_navyazivaniya_politiki_s_pomoschyu_git.html">
                            
                            <a href="../nastroika_git/primer_navyazivaniya_politiki_s_pomoschyu_git.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> Пример навязывания политики с помощью Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.5" data-path="nastroika_git/itogi.html">
                            
                            <a href="../nastroika_git/itogi.html">
                                <i class="fa fa-check"></i> <b>1.5.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="vvedenie/README.html">
                
                <a href="../vvedenie/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Введение
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="vvedenie/o_kontrole_versii.html">
                            
                            <a href="../vvedenie/o_kontrole_versii.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> О контроле версий
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="vvedenie/kratkaya_istoriya_git.html">
                            
                            <a href="../vvedenie/kratkaya_istoriya_git.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Краткая история Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="vvedenie/osnovi_git.html">
                            
                            <a href="../vvedenie/osnovi_git.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Основы Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="vvedenie/ustanovka_git.html">
                            
                            <a href="../vvedenie/ustanovka_git.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Установка Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="vvedenie/pervonachalnaya_nastroika_git.html">
                            
                            <a href="../vvedenie/pervonachalnaya_nastroika_git.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Первоначальная настройка Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="vvedenie/kak_poluchit_pomosch.html">
                            
                            <a href="../vvedenie/kak_poluchit_pomosch.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Как получить помощь?
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.7" data-path="vvedenie/itogi.html">
                            
                            <a href="../vvedenie/itogi.html">
                                <i class="fa fa-check"></i> <b>2.7.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="vetvlenie_v_git/README.html">
                
                <a href="../vetvlenie_v_git/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Ветвление в Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="vetvlenie_v_git/chto_takoe_vetka.html">
                            
                            <a href="../vetvlenie_v_git/chto_takoe_vetka.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Что такое ветка?
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="vetvlenie_v_git/osnovi_vetvleniya_i_sliyaniya.html">
                            
                            <a href="../vetvlenie_v_git/osnovi_vetvleniya_i_sliyaniya.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Основы ветвления и слияния
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="vetvlenie_v_git/upravlenie_vetkami.html">
                            
                            <a href="../vetvlenie_v_git/upravlenie_vetkami.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Управление ветками
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.4" data-path="vetvlenie_v_git/priyomi_raboti_s_vetkami.html">
                            
                            <a href="../vetvlenie_v_git/priyomi_raboti_s_vetkami.html">
                                <i class="fa fa-check"></i> <b>3.4.</b> Приёмы работы с ветками
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.5" data-path="vetvlenie_v_git/udalyonnie_vetki.html">
                            
                            <a href="../vetvlenie_v_git/udalyonnie_vetki.html">
                                <i class="fa fa-check"></i> <b>3.5.</b> Удалённые ветки
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.6" data-path="vetvlenie_v_git/peremeschenie.html">
                            
                            <a href="../vetvlenie_v_git/peremeschenie.html">
                                <i class="fa fa-check"></i> <b>3.6.</b> Перемещение
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.7" data-path="vetvlenie_v_git/itogi.html">
                            
                            <a href="../vetvlenie_v_git/itogi.html">
                                <i class="fa fa-check"></i> <b>3.7.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="4" data-path="git_na_servere/README.html">
                
                <a href="../git_na_servere/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Git на сервере
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="4.1" data-path="git_na_servere/protokoli.html">
                            
                            <a href="../git_na_servere/protokoli.html">
                                <i class="fa fa-check"></i> <b>4.1.</b> Протоколы
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.2" data-path="git_na_servere/nastroika_git_na_servere.html">
                            
                            <a href="../git_na_servere/nastroika_git_na_servere.html">
                                <i class="fa fa-check"></i> <b>4.2.</b> Настройка Git на сервере
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.3" data-path="git_na_servere/sozdanie_otkritogo_ssh_klyucha.html">
                            
                            <a href="../git_na_servere/sozdanie_otkritogo_ssh_klyucha.html">
                                <i class="fa fa-check"></i> <b>4.3.</b> Создание открытого SSH-ключа
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.4" data-path="git_na_servere/nastraivaem_server.html">
                            
                            <a href="../git_na_servere/nastraivaem_server.html">
                                <i class="fa fa-check"></i> <b>4.4.</b> Настраиваем сервер
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.5" data-path="git_na_servere/otkritii_dostup.html">
                            
                            <a href="../git_na_servere/otkritii_dostup.html">
                                <i class="fa fa-check"></i> <b>4.5.</b> Открытый доступ
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.6" data-path="git_na_servere/gitweb.html">
                            
                            <a href="../git_na_servere/gitweb.html">
                                <i class="fa fa-check"></i> <b>4.6.</b> GitWeb
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.7" data-path="git_na_servere/gitosis.html">
                            
                            <a href="../git_na_servere/gitosis.html">
                                <i class="fa fa-check"></i> <b>4.7.</b> Gitosis
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.8" data-path="git_na_servere/gitolite.html">
                            
                            <a href="../git_na_servere/gitolite.html">
                                <i class="fa fa-check"></i> <b>4.8.</b> Gitolite
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.9" data-path="git_na_servere/git_demon.html">
                            
                            <a href="../git_na_servere/git_demon.html">
                                <i class="fa fa-check"></i> <b>4.9.</b> Git-демон
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.10" data-path="git_na_servere/git_hosting.html">
                            
                            <a href="../git_na_servere/git_hosting.html">
                                <i class="fa fa-check"></i> <b>4.10.</b> Git-хостинг
                            </a>
                            
                        </li>
                    
                        <li  data-level="4.11" data-path="git_na_servere/itogi.html">
                            
                            <a href="../git_na_servere/itogi.html">
                                <i class="fa fa-check"></i> <b>4.11.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="5" data-path="raspredelyonnii_git/README.html">
                
                <a href="../raspredelyonnii_git/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Распределённый Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="raspredelyonnii_git/raspredelyonnie_rabochie_protsessi.html">
                            
                            <a href="../raspredelyonnii_git/raspredelyonnie_rabochie_protsessi.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Распределённые рабочие процессы
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.2" data-path="raspredelyonnii_git/sodeistvie_proektu.html">
                            
                            <a href="../raspredelyonnii_git/sodeistvie_proektu.html">
                                <i class="fa fa-check"></i> <b>5.2.</b> Содействие проекту
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.3" data-path="raspredelyonnii_git/soprovozhdenie_proekta.html">
                            
                            <a href="../raspredelyonnii_git/soprovozhdenie_proekta.html">
                                <i class="fa fa-check"></i> <b>5.3.</b> Сопровождение проекта
                            </a>
                            
                        </li>
                    
                        <li  data-level="5.4" data-path="raspredelyonnii_git/itogi.html">
                            
                            <a href="../raspredelyonnii_git/itogi.html">
                                <i class="fa fa-check"></i> <b>5.4.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="6" data-path="instrumenti_git/README.html">
                
                <a href="../instrumenti_git/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Инструменты Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="instrumenti_git/vibor_revizii.html">
                            
                            <a href="../instrumenti_git/vibor_revizii.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Выбор ревизии
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.2" data-path="instrumenti_git/interaktivnoe_indeksirovanie.html">
                            
                            <a href="../instrumenti_git/interaktivnoe_indeksirovanie.html">
                                <i class="fa fa-check"></i> <b>6.2.</b> Интерактивное индексирование
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.3" data-path="instrumenti_git/pryatane.html">
                            
                            <a href="../instrumenti_git/pryatane.html">
                                <i class="fa fa-check"></i> <b>6.3.</b> Прятанье
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.4" data-path="instrumenti_git/perezapis_istorii.html">
                            
                            <a href="../instrumenti_git/perezapis_istorii.html">
                                <i class="fa fa-check"></i> <b>6.4.</b> Перезапись истории
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.5" data-path="instrumenti_git/otladka_s_pomoschyu_git.html">
                            
                            <a href="../instrumenti_git/otladka_s_pomoschyu_git.html">
                                <i class="fa fa-check"></i> <b>6.5.</b> Отладка с помощью Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.6" data-path="instrumenti_git/podmoduli.html">
                            
                            <a href="../instrumenti_git/podmoduli.html">
                                <i class="fa fa-check"></i> <b>6.6.</b> Подмодули
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.7" data-path="instrumenti_git/sliyanie_podderevev.html">
                            
                            <a href="../instrumenti_git/sliyanie_podderevev.html">
                                <i class="fa fa-check"></i> <b>6.7.</b> Слияние поддеревьев
                            </a>
                            
                        </li>
                    
                        <li  data-level="6.8" data-path="instrumenti_git/itogi.html">
                            
                            <a href="../instrumenti_git/itogi.html">
                                <i class="fa fa-check"></i> <b>6.8.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="7" data-path="osnovi_git/README.html">
                
                <a href="../osnovi_git/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> Основы Git
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="7.1" data-path="osnovi_git/sozdanie_git_repozitoriya.html">
                            
                            <a href="../osnovi_git/sozdanie_git_repozitoriya.html">
                                <i class="fa fa-check"></i> <b>7.1.</b> Создание Git-репозитория
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.2" data-path="osnovi_git/zapis_izmenenii_v_repozitorii.html">
                            
                            <a href="../osnovi_git/zapis_izmenenii_v_repozitorii.html">
                                <i class="fa fa-check"></i> <b>7.2.</b> Запись изменений в репозиторий
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.3" data-path="osnovi_git/prosmotr_istorii_kommitov.html">
                            
                            <a href="../osnovi_git/prosmotr_istorii_kommitov.html">
                                <i class="fa fa-check"></i> <b>7.3.</b> Просмотр истории коммитов
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.4" data-path="osnovi_git/otmena_izmenenii.html">
                            
                            <a href="../osnovi_git/otmena_izmenenii.html">
                                <i class="fa fa-check"></i> <b>7.4.</b> Отмена изменений
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.5" data-path="osnovi_git/rabota_s_udalyonnimi_repozitoriyami.html">
                            
                            <a href="../osnovi_git/rabota_s_udalyonnimi_repozitoriyami.html">
                                <i class="fa fa-check"></i> <b>7.5.</b> Работа с удалёнными репозиториями
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.6" data-path="osnovi_git/rabota_s_metkami.html">
                            
                            <a href="../osnovi_git/rabota_s_metkami.html">
                                <i class="fa fa-check"></i> <b>7.6.</b> Работа с метками
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.7" data-path="osnovi_git/poleznie_soveti.html">
                            
                            <a href="../osnovi_git/poleznie_soveti.html">
                                <i class="fa fa-check"></i> <b>7.7.</b> Полезные советы
                            </a>
                            
                        </li>
                    
                        <li  data-level="7.8" data-path="osnovi_git/itogi.html">
                            
                            <a href="../osnovi_git/itogi.html">
                                <i class="fa fa-check"></i> <b>7.8.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="8" data-path="git_i_drugie_sistemi_kontrolya_versii/README.html">
                
                <a href="../git_i_drugie_sistemi_kontrolya_versii/README.html">
                    <i class="fa fa-check"></i> <b>8.</b> Git и другие системы контроля версий
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="8.1" data-path="git_i_drugie_sistemi_kontrolya_versii/git_i_subversion.html">
                            
                            <a href="../git_i_drugie_sistemi_kontrolya_versii/git_i_subversion.html">
                                <i class="fa fa-check"></i> <b>8.1.</b> Git и Subversion
                            </a>
                            
                        </li>
                    
                        <li  data-level="8.2" data-path="git_i_drugie_sistemi_kontrolya_versii/migratsiya_na_git.html">
                            
                            <a href="../git_i_drugie_sistemi_kontrolya_versii/migratsiya_na_git.html">
                                <i class="fa fa-check"></i> <b>8.2.</b> Миграция на Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="8.3" data-path="git_i_drugie_sistemi_kontrolya_versii/itogi.html">
                            
                            <a href="../git_i_drugie_sistemi_kontrolya_versii/itogi.html">
                                <i class="fa fa-check"></i> <b>8.3.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="9" data-path="git_iznutri/README.html">
                
                <a href="../git_iznutri/README.html">
                    <i class="fa fa-check"></i> <b>9.</b> Git изнутри
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="9.1" data-path="git_iznutri/santehnika_i_farfor.html">
                            
                            <a href="../git_iznutri/santehnika_i_farfor.html">
                                <i class="fa fa-check"></i> <b>9.1.</b> Сантехника и фарфор
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.2" data-path="git_iznutri/obekti_v_git.html">
                            
                            <a href="../git_iznutri/obekti_v_git.html">
                                <i class="fa fa-check"></i> <b>9.2.</b> Объекты в Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.3" data-path="git_iznutri/ssilki_v_git.html">
                            
                            <a href="../git_iznutri/ssilki_v_git.html">
                                <i class="fa fa-check"></i> <b>9.3.</b> Ссылки в Git
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.4" data-path="git_iznutri/pack_faili.html">
                            
                            <a href="../git_iznutri/pack_faili.html">
                                <i class="fa fa-check"></i> <b>9.4.</b> Pack-файлы
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.5" data-path="git_iznutri/spetsifikatsii_ssilok.html">
                            
                            <a href="../git_iznutri/spetsifikatsii_ssilok.html">
                                <i class="fa fa-check"></i> <b>9.5.</b> Спецификации ссылок
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.6" data-path="git_iznutri/protokoli_peredachi.html">
                            
                            <a href="../git_iznutri/protokoli_peredachi.html">
                                <i class="fa fa-check"></i> <b>9.6.</b> Протоколы передачи
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.7" data-path="git_iznutri/obsluzhivanie_i_vosstanovlenie_dannih.html">
                            
                            <a href="../git_iznutri/obsluzhivanie_i_vosstanovlenie_dannih.html">
                                <i class="fa fa-check"></i> <b>9.7.</b> Обслуживание и восстановление данных
                            </a>
                            
                        </li>
                    
                        <li  data-level="9.8" data-path="git_iznutri/itogi.html">
                            
                            <a href="../git_iznutri/itogi.html">
                                <i class="fa fa-check"></i> <b>9.8.</b> Итоги
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 62.857142857142854%;min-width: 61.42857142857143%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../nastroika_git/README.html" title="Настройка Git" class="chapter done new-chapter" data-progress="1" style="left: 1.4285714285714286%;"></a>
    
        <a href="../nastroika_git/konfigurirovanie_git.html" title="Конфигурирование Git" class="chapter done " data-progress="1.1" style="left: 2.857142857142857%;"></a>
    
        <a href="../nastroika_git/git_atributi.html" title="Git-атрибуты" class="chapter done " data-progress="1.2" style="left: 4.285714285714286%;"></a>
    
        <a href="../nastroika_git/perehvatchiki_v_git.html" title="Перехватчики в Git" class="chapter done " data-progress="1.3" style="left: 5.714285714285714%;"></a>
    
        <a href="../nastroika_git/primer_navyazivaniya_politiki_s_pomoschyu_git.html" title="Пример навязывания политики с помощью Git" class="chapter done " data-progress="1.4" style="left: 7.142857142857143%;"></a>
    
        <a href="../nastroika_git/itogi.html" title="Итоги" class="chapter done " data-progress="1.5" style="left: 8.571428571428571%;"></a>
    
        <a href="../vvedenie/README.html" title="Введение" class="chapter done new-chapter" data-progress="2" style="left: 10%;"></a>
    
        <a href="../vvedenie/o_kontrole_versii.html" title="О контроле версий" class="chapter done " data-progress="2.1" style="left: 11.428571428571429%;"></a>
    
        <a href="../vvedenie/kratkaya_istoriya_git.html" title="Краткая история Git" class="chapter done " data-progress="2.2" style="left: 12.857142857142858%;"></a>
    
        <a href="../vvedenie/osnovi_git.html" title="Основы Git" class="chapter done " data-progress="2.3" style="left: 14.285714285714286%;"></a>
    
        <a href="../vvedenie/ustanovka_git.html" title="Установка Git" class="chapter done " data-progress="2.4" style="left: 15.714285714285714%;"></a>
    
        <a href="../vvedenie/pervonachalnaya_nastroika_git.html" title="Первоначальная настройка Git" class="chapter done " data-progress="2.5" style="left: 17.142857142857142%;"></a>
    
        <a href="../vvedenie/kak_poluchit_pomosch.html" title="Как получить помощь?" class="chapter done " data-progress="2.6" style="left: 18.571428571428573%;"></a>
    
        <a href="../vvedenie/itogi.html" title="Итоги" class="chapter done " data-progress="2.7" style="left: 20%;"></a>
    
        <a href="../vetvlenie_v_git/README.html" title="Ветвление в Git" class="chapter done new-chapter" data-progress="3" style="left: 21.428571428571427%;"></a>
    
        <a href="../vetvlenie_v_git/chto_takoe_vetka.html" title="Что такое ветка?" class="chapter done " data-progress="3.1" style="left: 22.857142857142858%;"></a>
    
        <a href="../vetvlenie_v_git/osnovi_vetvleniya_i_sliyaniya.html" title="Основы ветвления и слияния" class="chapter done " data-progress="3.2" style="left: 24.285714285714285%;"></a>
    
        <a href="../vetvlenie_v_git/upravlenie_vetkami.html" title="Управление ветками" class="chapter done " data-progress="3.3" style="left: 25.714285714285715%;"></a>
    
        <a href="../vetvlenie_v_git/priyomi_raboti_s_vetkami.html" title="Приёмы работы с ветками" class="chapter done " data-progress="3.4" style="left: 27.142857142857142%;"></a>
    
        <a href="../vetvlenie_v_git/udalyonnie_vetki.html" title="Удалённые ветки" class="chapter done " data-progress="3.5" style="left: 28.571428571428573%;"></a>
    
        <a href="../vetvlenie_v_git/peremeschenie.html" title="Перемещение" class="chapter done " data-progress="3.6" style="left: 30%;"></a>
    
        <a href="../vetvlenie_v_git/itogi.html" title="Итоги" class="chapter done " data-progress="3.7" style="left: 31.428571428571427%;"></a>
    
        <a href="../git_na_servere/README.html" title="Git на сервере" class="chapter done new-chapter" data-progress="4" style="left: 32.857142857142854%;"></a>
    
        <a href="../git_na_servere/protokoli.html" title="Протоколы" class="chapter done " data-progress="4.1" style="left: 34.285714285714285%;"></a>
    
        <a href="../git_na_servere/git_hosting.html" title="Git-хостинг" class="chapter done " data-progress="4.10" style="left: 35.714285714285715%;"></a>
    
        <a href="../git_na_servere/itogi.html" title="Итоги" class="chapter done " data-progress="4.11" style="left: 37.142857142857146%;"></a>
    
        <a href="../git_na_servere/nastroika_git_na_servere.html" title="Настройка Git на сервере" class="chapter done " data-progress="4.2" style="left: 38.57142857142857%;"></a>
    
        <a href="../git_na_servere/sozdanie_otkritogo_ssh_klyucha.html" title="Создание открытого SSH-ключа" class="chapter done " data-progress="4.3" style="left: 40%;"></a>
    
        <a href="../git_na_servere/nastraivaem_server.html" title="Настраиваем сервер" class="chapter done " data-progress="4.4" style="left: 41.42857142857143%;"></a>
    
        <a href="../git_na_servere/otkritii_dostup.html" title="Открытый доступ" class="chapter done " data-progress="4.5" style="left: 42.857142857142854%;"></a>
    
        <a href="../git_na_servere/gitweb.html" title="GitWeb" class="chapter done " data-progress="4.6" style="left: 44.285714285714285%;"></a>
    
        <a href="../git_na_servere/gitosis.html" title="Gitosis" class="chapter done " data-progress="4.7" style="left: 45.714285714285715%;"></a>
    
        <a href="../git_na_servere/gitolite.html" title="Gitolite" class="chapter done " data-progress="4.8" style="left: 47.142857142857146%;"></a>
    
        <a href="../git_na_servere/git_demon.html" title="Git-демон" class="chapter done " data-progress="4.9" style="left: 48.57142857142857%;"></a>
    
        <a href="../raspredelyonnii_git/README.html" title="Распределённый Git" class="chapter done new-chapter" data-progress="5" style="left: 50%;"></a>
    
        <a href="../raspredelyonnii_git/raspredelyonnie_rabochie_protsessi.html" title="Распределённые рабочие процессы" class="chapter done " data-progress="5.1" style="left: 51.42857142857143%;"></a>
    
        <a href="../raspredelyonnii_git/sodeistvie_proektu.html" title="Содействие проекту" class="chapter done " data-progress="5.2" style="left: 52.857142857142854%;"></a>
    
        <a href="../raspredelyonnii_git/soprovozhdenie_proekta.html" title="Сопровождение проекта" class="chapter done " data-progress="5.3" style="left: 54.285714285714285%;"></a>
    
        <a href="../raspredelyonnii_git/itogi.html" title="Итоги" class="chapter done " data-progress="5.4" style="left: 55.714285714285715%;"></a>
    
        <a href="../instrumenti_git/README.html" title="Инструменты Git" class="chapter done new-chapter" data-progress="6" style="left: 57.142857142857146%;"></a>
    
        <a href="../instrumenti_git/vibor_revizii.html" title="Выбор ревизии" class="chapter done " data-progress="6.1" style="left: 58.57142857142857%;"></a>
    
        <a href="../instrumenti_git/interaktivnoe_indeksirovanie.html" title="Интерактивное индексирование" class="chapter done " data-progress="6.2" style="left: 60%;"></a>
    
        <a href="../instrumenti_git/pryatane.html" title="Прятанье" class="chapter done " data-progress="6.3" style="left: 61.42857142857143%;"></a>
    
        <a href="../instrumenti_git/perezapis_istorii.html" title="Перезапись истории" class="chapter done " data-progress="6.4" style="left: 62.857142857142854%;"></a>
    
        <a href="../instrumenti_git/otladka_s_pomoschyu_git.html" title="Отладка с помощью Git" class="chapter  " data-progress="6.5" style="left: 64.28571428571429%;"></a>
    
        <a href="../instrumenti_git/podmoduli.html" title="Подмодули" class="chapter  " data-progress="6.6" style="left: 65.71428571428571%;"></a>
    
        <a href="../instrumenti_git/sliyanie_podderevev.html" title="Слияние поддеревьев" class="chapter  " data-progress="6.7" style="left: 67.14285714285714%;"></a>
    
        <a href="../instrumenti_git/itogi.html" title="Итоги" class="chapter  " data-progress="6.8" style="left: 68.57142857142857%;"></a>
    
        <a href="../osnovi_git/README.html" title="Основы Git" class="chapter  new-chapter" data-progress="7" style="left: 70%;"></a>
    
        <a href="../osnovi_git/sozdanie_git_repozitoriya.html" title="Создание Git-репозитория" class="chapter  " data-progress="7.1" style="left: 71.42857142857143%;"></a>
    
        <a href="../osnovi_git/zapis_izmenenii_v_repozitorii.html" title="Запись изменений в репозиторий" class="chapter  " data-progress="7.2" style="left: 72.85714285714286%;"></a>
    
        <a href="../osnovi_git/prosmotr_istorii_kommitov.html" title="Просмотр истории коммитов" class="chapter  " data-progress="7.3" style="left: 74.28571428571429%;"></a>
    
        <a href="../osnovi_git/otmena_izmenenii.html" title="Отмена изменений" class="chapter  " data-progress="7.4" style="left: 75.71428571428571%;"></a>
    
        <a href="../osnovi_git/rabota_s_udalyonnimi_repozitoriyami.html" title="Работа с удалёнными репозиториями" class="chapter  " data-progress="7.5" style="left: 77.14285714285714%;"></a>
    
        <a href="../osnovi_git/rabota_s_metkami.html" title="Работа с метками" class="chapter  " data-progress="7.6" style="left: 78.57142857142857%;"></a>
    
        <a href="../osnovi_git/poleznie_soveti.html" title="Полезные советы" class="chapter  " data-progress="7.7" style="left: 80%;"></a>
    
        <a href="../osnovi_git/itogi.html" title="Итоги" class="chapter  " data-progress="7.8" style="left: 81.42857142857143%;"></a>
    
        <a href="../git_i_drugie_sistemi_kontrolya_versii/README.html" title="Git и другие системы контроля версий" class="chapter  new-chapter" data-progress="8" style="left: 82.85714285714286%;"></a>
    
        <a href="../git_i_drugie_sistemi_kontrolya_versii/git_i_subversion.html" title="Git и Subversion" class="chapter  " data-progress="8.1" style="left: 84.28571428571429%;"></a>
    
        <a href="../git_i_drugie_sistemi_kontrolya_versii/migratsiya_na_git.html" title="Миграция на Git" class="chapter  " data-progress="8.2" style="left: 85.71428571428571%;"></a>
    
        <a href="../git_i_drugie_sistemi_kontrolya_versii/itogi.html" title="Итоги" class="chapter  " data-progress="8.3" style="left: 87.14285714285714%;"></a>
    
        <a href="../git_iznutri/README.html" title="Git изнутри" class="chapter  new-chapter" data-progress="9" style="left: 88.57142857142857%;"></a>
    
        <a href="../git_iznutri/santehnika_i_farfor.html" title="Сантехника и фарфор" class="chapter  " data-progress="9.1" style="left: 90%;"></a>
    
        <a href="../git_iznutri/obekti_v_git.html" title="Объекты в Git" class="chapter  " data-progress="9.2" style="left: 91.42857142857143%;"></a>
    
        <a href="../git_iznutri/ssilki_v_git.html" title="Ссылки в Git" class="chapter  " data-progress="9.3" style="left: 92.85714285714286%;"></a>
    
        <a href="../git_iznutri/pack_faili.html" title="Pack-файлы" class="chapter  " data-progress="9.4" style="left: 94.28571428571429%;"></a>
    
        <a href="../git_iznutri/spetsifikatsii_ssilok.html" title="Спецификации ссылок" class="chapter  " data-progress="9.5" style="left: 95.71428571428571%;"></a>
    
        <a href="../git_iznutri/protokoli_peredachi.html" title="Протоколы передачи" class="chapter  " data-progress="9.6" style="left: 97.14285714285714%;"></a>
    
        <a href="../git_iznutri/obsluzhivanie_i_vosstanovlenie_dannih.html" title="Обслуживание и восстановление данных" class="chapter  " data-progress="9.7" style="left: 98.57142857142857%;"></a>
    
        <a href="../git_iznutri/itogi.html" title="Итоги" class="chapter  " data-progress="9.8" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_703">
                    
                        <h1 id="-">Перезапись истории</h1>
<p>Неоднократно во время работы с Git&#39;ом, вам может захотеться по какой-либо причине исправить свою историю коммитов. Одна из чудесных особенностей Git&#39;а заключается в том, что он даёт возможность принять решение в самый последний момент. Используя индекс, вы можете решить, какие файлы пойдут в какие коммиты, непосредственно перед тем, как сделать коммит. Вы можете воспользоваться командой <code>stash</code>, решив, что над чем-то ещё не стоило начинать работать. А также вы можете переписать уже сделанные коммиты так, будто они были сделаны как-то по-другому. В частности, это может быть изменение порядка следования коммитов, редактирование сообщений или модифицирование файлов в коммите, уплотнение и разделение коммитов, а также полное удаление некоторых коммитов — но только до того, как вы поделитесь наработками с другими.</p>
<p>В этом разделе вы узнаете, как делать подобные полезные вещи, чтобы перед публикацией приводить историю коммитов в желаемый вид.</p>
<h2 id="-">Изменение последнего коммита</h2>
<p>Изменение последнего коммита — это, вероятно, наиболее типичный случай переписывания истории, который вы будете делать. Как правило, вам от вашего последнего коммита понадобятся две основные вещи: изменить сообщение коммита или изменить только что записанный снимок состояния, добавив, изменив или удалив из него файлы.</p>
<p>Если вы всего лишь хотите изменить сообщение последнего коммита — это очень просто:</p>
<pre><code>$ git commit --amend
</code></pre><p>Выполнив это, вы попадёте в свой текстовый редактор, в котором будет находиться сообщение последнего коммита, готовое к тому, чтобы его отредактировали. Когда вы сохраните текст и закроете редактор, Git создаст новый коммит с вашим сообщением и сделает его новым последним коммитом.</p>
<p>Если вы сделали коммит и затем хотите изменить снимок состояния в коммите, добавив или изменив файлы, допустим, потому что вы забыли добавить только что созданный файл, когда делали коммит, то процесс выглядит в основном так же. Вы добавляете в индекс изменения, которые хотите, редактируя файл и выполняя для него <code>git add</code> или выполняя <code>git rm</code> для отслеживаемого файла, и затем <code>git commit --amend</code> возьмёт текущий индекс и сделает его снимком состояния нового коммита.</p>
<p>Будьте осторожны, используя этот приём, потому что <code>git commit --amend</code> меняет SHA-1 коммита. Тут как с маленьким перемещением (rebase) — не правьте последний коммит, если вы его уже куда-то отправили.</p>
<h2 id="-">Изменение сообщений нескольких коммитов</h2>
<p>Чтобы изменить коммит, находящийся глубоко в истории, вам придётся перейти к использованию более сложных инструментов. В Git&#39;е нет специального инструмента для редактирования истории, но вы можете использовать <code>rebase</code> для перемещения ряда коммитов на то же самое место, где они были изначально, а не куда-то в другое место. Используя инструмент для интерактивного перемещения, вы можете останавливаться на каждом коммите, который хотите изменить, и редактировать сообщение, добавлять файлы или делать что-то ещё. Интерактивное перемещение можно запустить, добавив опцию <code>-i</code> к <code>git rebase</code>. Необходимо указать, насколько далёкие в истории коммиты вы хотите переписать, сообщив команде, на какой коммит выполняется перемещение.</p>
<p>Например, если вы хотите изменить сообщения последних трёх коммитов или сообщения для только некоторых коммитов в этой группе, вам надо передать в <code>git rebase -i</code> в качестве аргумента родителя последнего коммита, который вы хотите изменить, то есть <code>HEAD~2^</code> или <code>HEAD~3</code>. Наверное, проще запомнить <code>~3</code>, потому что вы пытаетесь отредактировать три последних коммита, но имейте в виду, что на самом деле вы обозначили четвёртый сверху коммит — родительский коммит для того, который хотите отредактировать:</p>
<pre><code>$ git rebase -i HEAD~3
</code></pre><p>Снова напомним, что это команда для перемещения, то есть все коммиты в диапазоне <code>HEAD~3..HEAD</code> будут переписаны вне зависимости от того, меняли ли вы в них сообщение или нет. Не трогайте те коммиты, которые вы уже отправили на центральный сервер — сделав так, вы запутаете других разработчиков, дав им разные версии одних и тех же изменений.</p>
<p>Запуск этой команды выдаст вам в текстовом редакторе список коммитов, который будет выглядеть следующим образом:</p>
<pre><code>pick f7f3f6d changed my name a bit
pick 310154e updated README formatting and added blame
pick a5f4a0d added cat-file

# Rebase 710f0f8..a5f4a0d onto 710f0f8
#
# Commands:
#  p, pick = use commit
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
#
</code></pre><p>Важно отметить, что эти коммиты выведены в обратном порядке по сравнению с тем, как вы их обычно видите, используя команду <code>log</code>. Запустив <code>log</code>, вы получите что-то вроде этого:</p>
<pre><code>$ git log --pretty=format:&quot;%h %s&quot; HEAD~3..HEAD
a5f4a0d added cat-file
310154e updated README formatting and added blame
f7f3f6d changed my name a bit
</code></pre><p>Обратите внимание на обратный порядок. Интерактивное перемещение выдаёт сценарий, который будет выполнен. Он начнётся с коммита, который вы указали в командной строке (<code>HEAD~3</code>), и воспроизведёт изменения, сделанные каждым из этих коммитов, сверху вниз. Наверху указан самый старый коммит, а не самый новый, потому что он будет воспроизведён первым.</p>
<p>Вам надо отредактировать сценарий так, чтобы он останавливался на коммитах, которые вы хотите отредактировать. Чтобы сделать это, замените слово pick на слово edit для каждого коммита, на котором сценарий должен остановиться. Например, чтобы изменить сообщение только для третьего коммита, отредактируйте файл так, чтобы он выглядел следующим образом:</p>
<pre><code>edit f7f3f6d changed my name a bit
pick 310154e updated README formatting and added blame
pick a5f4a0d added cat-file
</code></pre><p>Когда вы сохраните и выйдете из редактора, Git откатит вас назад к последнему коммиту в списке и выкинет вас в командную строку, выдав следующее сообщение:</p>
<pre><code>$ git rebase -i HEAD~3
Stopped at 7482e0d... updated the gemspec to hopefully work better
You can amend the commit now, with

       git commit --amend

Once you’re satisfied with your changes, run

       git rebase --continue
</code></pre><p>В этой инструкции в точности сказано, что надо сделать. Наберите</p>
<pre><code>$ git commit --amend
</code></pre><p>Измените сообщение коммита и выйдите из редактора. Теперь выполните</p>
<pre><code>$ git rebase --continue
</code></pre><p>Данная команда применит оставшиеся два коммита автоматически и закончит на этом. Если вы измените pick на edit для большего количества строк, то вы повторите эти шаги для каждого коммита, где вы напишете edit. Каждый раз Git будет останавливаться, давая вам исправить коммит, а потом, когда вы закончите, будет продолжать.</p>
<h2 id="-">Переупорядочение коммитов</h2>
<p>Интерактивное перемещение можно также использовать для изменения порядка следования и для полного удаления коммитов. Если вы хотите удалить коммит &quot;added cat-file&quot; и поменять порядок, в котором идут два других коммита, измените сценарий для rebase с такого</p>
<pre><code>pick f7f3f6d changed my name a bit
pick 310154e updated README formatting and added blame
pick a5f4a0d added cat-file
</code></pre><p>на такой:</p>
<pre><code>pick 310154e updated README formatting and added blame
pick f7f3f6d changed my name a bit
</code></pre><p>Когда вы сохраните и выйдете из редактора, Git откатит вашу ветку к родительскому для этих трёх коммиту, применит <code>310154e</code>, затем <code>f7f3f6d</code>, а потом остановится. Вы фактически поменяли порядок следования коммитов и полностью удалили коммит &quot;added cat-file&quot;.</p>
<h2 id="-">Уплотнение коммитов</h2>
<p>С помощью интерактивного перемещения также возможно взять несколько коммитов и сплющить их в один коммит. Сценарий выдаёт полезное сообщение с инструкциями для перемещения:</p>
<pre><code>#
# Commands:
#  p, pick = use commit
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
#
</code></pre><p>Если вместо &quot;pick&quot; или &quot;edit&quot; указать &quot;squash&quot;, Git применит изменения и из этого коммита, и из предыдущего, а затем даст вам объединить сообщения для коммитов. Итак, чтобы сделать один коммит из трёх наших коммитов, надо сделать так, чтобы сценарий выглядел следующим образом:</p>
<pre><code>pick f7f3f6d changed my name a bit
squash 310154e updated README formatting and added blame
squash a5f4a0d added cat-file
</code></pre><p>Когда вы сохраните и выйдете из редактора, Git применит все три изменения, а затем опять выдаст вам редактор для того, чтобы объединить сообщения трёх коммитов:</p>
<pre><code># This is a combination of 3 commits.
# The first commit&#39;s message is:
changed my name a bit

# This is the 2nd commit message:

updated README formatting and added blame

# This is the 3rd commit message:

added cat-file
</code></pre><p>Когда вы это сохраните, у вас будет один коммит, который вносит изменения такие же, как три бывших коммита.</p>
<h2 id="-">Разбиение коммита</h2>
<p>Разбиение коммита — это отмена коммита, а затем индексирование изменений частями и добавление коммитов столько раз, сколько коммитов вы хотите получить. Предположим, что вы хотите разбить средний из наших трёх коммитов. Вместо &quot;updated README formatting and added blame&quot; вы хотите получить два отдельных коммита: &quot;updated README formatting&quot; в качестве первого и &quot;added blame&quot; в качестве второго. Вы можете сделать это в сценарии <code>rebase -i</code>, поставив &quot;edit&quot; в инструкции для коммита, который хотите разбить:</p>
<pre><code>pick f7f3f6d changed my name a bit
edit 310154e updated README formatting and added blame
pick a5f4a0d added cat-file
</code></pre><p>Когда вы сохраните и выйдете из редактора, Git откатится к родителю первого коммита в списке, применит первый коммит (<code>f7f3f6d</code>), применит второй (<code>310154e</code>) и выбросит вас в консоль. Здесь вы можете сбросить последний коммит в смешанном режиме с помощью <code>git reset HEAD^</code> — это в сущности отменит этот коммит и оставит изменённые файлы непроиндексированными. Теперь вы можете взять сброшенные изменения и создать из них несколько коммитов. Просто добавляйте файлы в индекс и делайте коммиты, пока не сделаете несколько штук. Затем, когда закончите, выполните <code>git rebase --continue</code>:</p>
<pre><code>$ git reset HEAD^
$ git add README
$ git commit -m &#39;updated README formatting&#39;
$ git add lib/simplegit.rb
$ git commit -m &#39;added blame&#39;
$ git rebase --continue
</code></pre><p>Когда Git применит последний коммит (<code>a5f4a0d</code>) в сценарии, история будет выглядеть так:</p>
<pre><code>$ git log -4 --pretty=format:&quot;%h %s&quot;
1c002dd added cat-file
9b29157 added blame
35cfb2b updated README formatting
f3cc40e changed my name a bit
</code></pre><p>Повторимся ещё раз, что эта операция меняет SHA всех коммитов в списке, так что убедитесь, что ни один из коммитов в этом списке вы ещё не успели отправить в общий репозиторий.</p>
<h2 id="-filter-branch">Крайнее средство: filter-branch</h2>
<p>Есть ещё один вариант переписывания истории, который можно использовать, если надо переписать большое количество коммитов в автоматизируемой форме — например, везде поменять свой e-mail адрес или удалить файл из каждого коммита — это команда <code>filter-branch</code>. Она может переписать огромные периоды вашей истории, так что, возможно, вообще не стоит использовать её, если ваш проект успел стать публичным и другие люди уже работают на основе коммитов, которые вы собрались переписать. Однако, она может быть весьма полезной. Мы посмотрим на некоторые типичные варианты использования команды так, чтобы вы получили представление о тех вещах, на которые она способна.</p>
<h3 id="-">Удаление файла изо всех коммитов</h3>
<p>Такое случается довольно часто. Кто-нибудь случайно добавляет в коммит огромный бинарный файл, необдуманно выполнив <code>git add .</code>, и вы хотите удалить его отовсюду. Или, может быть, вы нечаянно добавили в коммит файл содержащий пароль, а теперь хотите сделать код этого проекта открытым. <code>filter-branch</code> — это тот инструмент, который вы наверняка захотите использовать, чтобы прочесать всю историю. Чтобы удалить файл с именем passwords.txt изо всей истории, используйте опцию <code>--tree-filter</code> для <code>filter-branch</code>:</p>
<pre><code>$ git filter-branch --tree-filter &#39;rm -f passwords.txt&#39; HEAD
Rewrite 6b9b3cf04e7c5686a9cb838c3f36a8cb6a0fc2bd (21/21)
Ref &#39;refs/heads/master&#39; was rewritten
</code></pre><p>Опция <code>--tree-filter</code> выполняет указанную команду после выгрузки каждой версии проекта и затем заново делает коммит из результата. В нашем случае мы удалили файл с именем passwords.txt из каждого снимка состояния независимо от того, существовал ли он там или нет. Если вы хотите удалить все случайно добавленные резервные копии, сделанные вашим текстовым редактором, выполните что-то типа <code>git filter-branch --tree-filter &quot;find * -type f -name &#39;*~&#39; -delete&quot; HEAD</code>.</p>
<p>Вы увидите, как Git переписывает деревья и коммиты, а в конце переставляет указатель ветки. Как правило, хороший вариант — делать это в тестовой ветке, а затем жёстко сбрасывать ветку master с помощью <code>reset --hard</code>, когда вы поймёте, что результат — это то, чего вы действительно добивались. Чтобы запустить <code>filter-branch</code> для всех веток, можно передать команде параметр <code>--all</code>.</p>
<h3 id="-">Сделать подкаталог новым корнем</h3>
<p>Предположим, вы импортировали репозиторий из другой системы контроля версий, и в нём есть бессмысленные каталоги (trunk, tags, и др.). Если вы хотите сделать <code>trunk</code> новым корнем проекта, команда <code>filter-branch</code> может помочь вам сделать и это:</p>
<pre><code>$ git filter-branch --subdirectory-filter trunk HEAD
Rewrite 856f0bf61e41a27326cdae8f09fe708d679f596f (12/12)
Ref &#39;refs/heads/master&#39; was rewritten
</code></pre><p>Теперь всюду корневой каталог проекта будет в подкаталоге <code>trunk</code>. Git также автоматически удалит все коммиты, которые не затрагивают данный подкаталог.</p>
<h3 id="-e-mail-">Глобальное изменение e-mail адреса</h3>
<p>Ещё один типичный случай — это, когда вы забыли выполнить <code>git config</code>, чтобы задать своё имя и e-mail адрес, перед тем как начать работать. Или, возможно, вы хотите открыть код своего проекта с работы и поменять все свои рабочие e-mail&#39;ы на свой личный адрес. В любом случае с помощью <code>filter-branch</code> вы с таким же успехом можете поменять адреса почты в нескольких коммитах за один раз. Вам надо быть аккуратным, чтобы не поменять и чужие адреса, поэтому используйте <code>--commit-filter</code>:</p>
<pre><code>$ git filter-branch --commit-filter &#39;
        if [ &quot;$GIT_AUTHOR_EMAIL&quot; = &quot;schacon@localhost&quot; ];
        then
                GIT_AUTHOR_NAME=&quot;Scott Chacon&quot;;
                GIT_AUTHOR_EMAIL=&quot;schacon@example.com&quot;;
                git commit-tree &quot;$@&quot;;
        else
                git commit-tree &quot;$@&quot;;
        fi&#39; HEAD
</code></pre><p>Эта команда проходит по всем коммитам и переписывает их так, чтобы там был указан новый адрес. Так как коммиты содержат значения SHA-1 своих родителей, эта команда поменяет все SHA в вашей истории, а не только те, в которых есть указанный e-mail адрес.</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../instrumenti_git/pryatane.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../instrumenti_git/otladka_s_pomoschyu_git.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
